---
title: "Silvia Sacchi - D00262683 -CA4"
subtitle: "Linear Regression Analysis of gaming habits"
author: "Silvia Sacchi"
output: 
 html_notebook:
   toc: true
   number_sections: true
   toc_float: true
editor_options: 
  chunk_output_type: inline
---

```{r}
#OPENING CSV FILE
lr <- read.csv ("C:\\Users\\Silvia\\OneDrive - Dundalk Institute of Technology\\University\\Data Analytics for Immersive Environments\\CA4\\amalgamated_game_survey_250_2022.csv")
lr
```

```{r}
#SELECTING SAMPLE OF 200 OBSERVATIONS
set.seed(12) #setting seed so that the sampling can be reproduced by anyone using this code
sample <- sample (1:nrow(lr), 200, replace = FALSE) #selecting 200 observation without replacement
sample
lr_sample <- lr [sample, ] #creating new dataset containing of the sample
lr_sample
```
```{r}
#SELECTING VARIABLES TO TEST
#The aim of this analysis is to test the relationship between two numerical variables via linear regression. 
#In particular, the relationship between the average monthly time spent playing (avg_monthly_hrs_gaming) and
#the average monthly amount spent on downloadable content (avg_monthly_expenditure_dlc) will be analysed.

#Since there is no clear indication of the unit of measurement for the monthly expenditure, it will be assumed that
#each amount is expressed in US dollars ($).

#What's expected is to see a higher expenditure among those who spend more time playing. In other words, the time spent 
#playing (explanatory variable) is expected to be predictive of the amount of money a gamer will spend on downloadable
#content (response variable).

#Based on all this a set of hypotheses was created:
#H0: β1 = 0
#HA: β1 ≠ 0

#β1 is the average change in monthly expenditure associated with a one unit increase in monthly hours spent playing.

#To rephrase it, the null hypothesis predicts a non-significant level of predictability between the time spent playing
#and the monthly expenditure on downloadable content, while the alternative hypothesis predicts a significant
#impact of monthly hours spent playing on the average monthly expenditure of the player.
```
```{r}
#SIMPLIFYING: instead of calling the column name each time a variable is analysed or tested, a new vector
#will be created with the values of that same column. Such new variable will then be used for all analyses.

time <- lr_sample$avg_monthly_hrs_gaming #creating new vector for monthly time spent playing
time

exp <- lr_sample$avg_monthly_expenditure_dlc #creating new vector for the monthly expenditure on downloadable content
exp
```

```{r}
#DESCRIPTIVE STATISTICS

#time
```

```{r}
mean_time <- mean (time) #finding average monthly hours spent playing
mean_time
```
```{r}
median_time <- median (time) #finding median  value for monthly hours spent playing
median_time
```
```{r}
getmode <- function(v) { # creating function to find mode
  uniqv <- unique(v)
  uniqv[which.max(tabulate(match(v, uniqv)))]
}

mode_time <- getmode (time) #finding mode value for the monthly amount of time spent playing
mode_time
```
```{r}
sd_time <- sd (time) #finding standard deviation for the monthly amount of time spent playing
sd_time
```
```{r}
var_time <- var (time) #finding variance for the monthly amount of time spent playing 
var_time
```
```{r}
iqr_time <- IQR (time) #finding IQR for the monthly amount of time spent playing
iqr_time
```
```{r}
quartiles_time <- quantile (time, prob=c(.25,.5,.75)) #finding quartiles for the monthly time spent playing
quartiles_time
```
```{r}
boxplot (time, main='Monthly amount of hours spent playing video games', ylab='Time (h) sent playing video-games monthly') #creating box plot of time spent playing

#One outlier can be visually identified in the lower part of the distribution.
#Since it's only one observation out of 200 the impact of such outlier can been considered negligible.
```
```{r}
min_time <- min (time) #finding minimum monthly amount of hours in the datset that a subject played video-games
min_time
```
```{r}
max_time <- max (time) #finding maximum monthly amount of hours in the datset that a subject played video-games
max_time
```
```{r}
range_time <- max_time - min_time #finding range for monthly time spent playing
range_time
```
```{r}
#expenditure
```
```{r}
mean_exp <- mean (exp) #finding average monthly amount spent on downloadable content
mean_exp
```
```{r}
median_exp <- median (exp) #finding median value for monthly expenditure for downloadable content
median_exp
```
```{r}
mode_exp <- getmode (exp) #finding mode value for the monthly expenditure for downloadable content
mode_exp
```
```{r}
sd_exp <- sd (exp) #finding standard deviation for the monthly amount spent on downloadable content
sd_exp
```
```{r}
var_exp <- var (exp) #finding variance for the monthly amount spent on donloadable content
var_exp
```
```{r}
iqr_exp <- IQR (exp) #finding IQR for the monthly amount spent on downloadable content
iqr_exp
```
```{r}
quartiles_exp <- quantile (exp, prob=c(.25,.5,.75)) #finding quartiles for the monthly downloadable content expenditure
quartiles_exp
```
```{r}
boxplot (exp, main='Monthly amount ($) spent on downloadable content', ylab='Amount ($) spent monthly on downloadable content') #creating box of plot monthly expenditure

#no visible outliers
```
```{r}
min_exp <- min (exp) #finding minimum monthly amount of hours spent on downloadable content
min_exp
```
```{r}
max_exp <- max (exp) #finding maximum monthly amount spent on downloadable content
max_exp
```
```{r}
range_exp <- max_exp - min_exp #finding range for monthly expenditure
range_exp
```
```{r}
#TESTING FOR NORMALITY: Linear regression does not require normality, but for the sake of being thorough normality test will be run anyways.

#time
```
```{r}
hist (time, col='Blue', main='Distribution of monthly time spent playing video-games', xlab='Time (h)')
#creating histogram of the distribution for the variable time

#the distribution does not seem normal. Further tests will be carried out.
```
```{r}
qqnorm (time, main='Distribution of monthly time spent playing video-games') #creating q-q- plot for the distribution of the variable time
qqline (time) #adding interpolation line

#the distribution does not appear to be normal. More testing will be performed.
```
```{r}
shapiro.test (time) #performing Shapiro-Wild test for normality

#With p < 0.001 the null hypothesis must be rejected. The data are not normal.
```
```{r}
#exp
```
```{r}
hist (exp, col='Red', main='Distribution of average monthly expenditure on downloadable content', xlab='Expenditure ($)')
#creating histogram of the distribution for the variable exp

#the distribution does not seem normal. Further tests will be carried out.
```
```{r}
qqnorm (exp, main='Distribution of monthly expenditure on dowloadable content') #creating q-q- plot for the distribution of the variable exp
qqline (exp) #adding interpolation line

#the distribution does not appear to be normal. More testing will be performed.
```
```{r}
shapiro.test (exp) #performing Shapiro-Wild test for normality

#With p < 0.001 the null hypothesis must be rejected. The data are not normal.
```
















